<div id="notesModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="notesModalTitle">
    <div class="modal-content">
        <button class="modal-close-button" onclick="closeModal()">&times;</button>
        <h3 id="notesModalTitle" class="text-xl font-semibold mb-2">Tasting Notes & Image</h3>
        <p id="notesModalWineName" class="mb-4 text-gray-700"></p>
        <form id="notesForm">
            <input type="hidden" id="notesVivinoUrl">

            <div class="mb-4">
                <div class="flex justify-between items-center">
                    <label for="imageUrlInput" class="block text-sm font-medium mb-1">Image URL</label>
                    <button type="button" id="toggleImageUrlLock"
                        class="text-gray-500 hover:text-gray-700 focus:outline-none">üîí</button>
                </div>
                <input type="text" id="imageUrlInput" placeholder="Paste new image URL here"
                    class="w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" readonly>
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-1">Image Preview & Focal Point</label>
                <!-- Reverted to a simpler structure for debugging -->
                <div id="focalPointEditor" class="overflow-hidden rounded-md bg-gray-100 dark:bg-gray-800">
                    <img id="draggableImage" src="" alt="Wine bottle image" draggable="false"
                        class="transition-transform duration-300">
                </div>
            </div>

            <!-- Zoom Slider -->
            <div class="mb-4">
                <label for="zoomSlider" class="block text-sm font-medium mb-1">Zoom</label>
                <input type="range" id="zoomSlider" min="1" max="3" step="0.05" value="1"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled>
            </div>


            <div class="mb-4">
                <label for="tastingNotesInput" class="block text-sm font-medium mb-1">Tasting Notes</label>
                <textarea id="tastingNotesInput" rows="5" placeholder="Enter your notes here..."
                    class="w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"></textarea>
            </div>

            <div id="notesMessage" class="mt-4 text-center hidden"></div>
            <div class="mt-6 flex justify-end gap-4">
                <button type="button" onclick="closeModal()"
                    class="bg-gray-200 text-gray-600 px-6 py-2 rounded-md hover:bg-gray-300">Cancel</button>
                <button type="submit" id="notesSubmitBtn"
                    class="bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700">Save Changes</button>
            </div>
        </form>
        <hr class="my-6 border-gray-300">
        <div>
            <div class="flex justify-between items-center mb-3">
                <h4 class="text-lg font-medium text-gray-800">Consumption Log</h4>
                <button id="logSortToggleBtn" title="Reverse Sort Order" class="icon-button text-xl">‚ÜïÔ∏è</button>
            </div>
            <div id="consumptionLogContainer"
                class="text-sm text-gray-700 space-y-2 max-h-48 overflow-y-auto p-3 border rounded-md bg-gray-50 dark:bg-gray-700">
            </div>
        </div>
    </div>
</div>